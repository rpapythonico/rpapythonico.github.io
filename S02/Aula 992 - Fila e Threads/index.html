<!DOCTYPE html>
<html class="writer-html5" lang="pt_BR" >
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><link rel="canonical" href="https://rpapythonico.github.io/S02/Aula%20992%20-%20Fila%20e%20Threads/" />
      <link rel="shortcut icon" href="../../img/favicon.ico" />
    <title>Aula 992 - Fila e Threads - RPA Pythonico</title>
    <link rel="stylesheet" href="../../css/theme.css" />
    <link rel="stylesheet" href="../../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/styles/github.min.css" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "Aula 992 - Fila e Threads";
        var mkdocs_page_input_path = "S02\\Aula 992 - Fila e Threads.md";
        var mkdocs_page_url = "/S02/Aula%20992%20-%20Fila%20e%20Threads/";
      </script>
    
    <script src="../../js/jquery-3.6.0.min.js" defer></script>
    <!--[if lt IE 9]>
      <script src="../../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/highlight.min.js"></script>
      <script>hljs.initHighlightingOnLoad();</script> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href="../.." class="icon icon-home"> RPA Pythonico
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../..">Principal</a>
                </li>
              </ul>
              <p class="caption"><span class="caption-text">Temporada 2</span></p>
              <ul class="current">
                  <li class="toctree-l1"><a class="reference internal" href="#">Introdução</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../Aula%200%20-%20Instala%C3%A7%C3%A3o%20Python/">Aula 0 - Instalação Python</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../Aula%201%20-%20Distribui%C3%A7%C3%B5es/">Aula 1 - Distribuições</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../Aula%202%20-%20IDEs/">Aula 2 - IDEs</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="#">Aula 3 - Variáveis</a>
    <ul>
                <li class="toctree-l3"><a class="reference internal" href="../Aula%203%20-%20Vari%C3%A1veis/">Visão Geral</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../Aula%203.1%20-%20Manipula%C3%A7%C3%A3o%20de%20Strings/">Manipulação de Strings</a>
                </li>
    </ul>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../Aula%204%20-%20Variaveis%20Compostas/">Aula 4 - Variaveis Compostas</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../Aula%205%20-%20Identa%C3%A7%C3%A3o%20e%20Condicionais/">Aula 5 - Identação e Condicionais</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../Aula%206%20-%20Operadores%20Aritm%C3%A9ticos/">Aula 6 - Operadores Aritméticos</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../Aula%207%20-%20Operadores%20Comparativos/">Aula 7 - Operadores Comparativos</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../Aula%208%20-%20Fun%C3%A7%C3%B5es/">Aula 8 - Funções</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../Aula%209%20-%20Looping/">Aula 9 - Looping</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../Aula%2010%20-%20Tratativas%20de%20Erros/">Aula 10 - Tratativas de Erros</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../Aula%2011%20-%20Instala%C3%A7%C3%A3o%20e%20Importa%C3%A7%C3%A3o%20de%20Bibliotecas/">Aula 11 - Instalação e Importação de Bibliotecas</a>
                </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="#">Intermediário</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../Aula%2012%20-%20Sistema%20Operacional/">Aula 12 - Sistema Operacional</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../Aula%2013%20-%20Constants/">Aula 13 - Constants</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../Aula%2014%20-%20Interagindo%20com%20Arquivos/">Aula 14 - Interagindo com Arquivos</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../Aula%2015%20-%20Openpyxl/">Aula 15 - Openpyxl</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../Aula%2016%20-%20Xlsxwriter/">Aula 16 - Xlsxwriter</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../Aula%2017%20-%20Pandas/">Aula 17 - Pandas</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../Aula%2018%20-%20CSV/">Aula 18 - CSV</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../Aula%2019%20-%20Pdfs/">Aula 19 - Pdfs</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../Aula%2020%20-%20Email/">Aula 20 - Email</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../Aula%2021%20-%20RegEx/">Aula 21 - RegEx</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="#">Aula 22 - Selenium</a>
    <ul>
                <li class="toctree-l3"><a class="reference internal" href="../Aula%2022.0%20-%20Selenium%20-%20Vis%C3%A3o%20Geral/">Visão Geral</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../Aula%2022.1%20-%20Selenium%20-%20Navegador/">Navegador</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../Aula%2022.2%20-%20Selenium%20-%20Intera%C3%A7%C3%B5es/">Interações</a>
                </li>
    </ul>
                </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="#">Avançado</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../Aula%2023%20-%20BeautifulSoup/">Aula 23 - BeautifulSoup</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../Aula%2024%20-%20APIs/">Aula 24 - APIs</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="#">Aula 25 - Bancos de Dados</a>
    <ul>
                <li class="toctree-l3"><a class="reference internal" href="../Aula%2025.0%20-%20DBs%20-%20Geral/">Visão Geral</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../Aula%2025.1%20-%20DBs%20-%20Queries/">Queries</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../Aula%2025.2%20-%20DBs%20-%20Python/">Python</a>
                </li>
    </ul>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../Aula%2026%20-%20Orienta%C3%A7%C3%A3o%20a%20Objetos/">Aula 26 - Orientação a Objetos</a>
                </li>
    </ul>
                  </li>
                  <li class="toctree-l1 current"><a class="reference internal current" href="#">Extras</a>
    <ul class="current">
                <li class="toctree-l2"><a class="reference internal" href="../Aula%20990%20-%20Datetime/">Aula 990 - Datetime</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../Aula%20991%20-%20Decoradores/">Aula 991 - Decoradores</a>
                </li>
                <li class="toctree-l2 current"><a class="reference internal current" href="./">Aula 992 - Fila e Threads</a>
    <ul class="current">
    <li class="toctree-l3"><a class="reference internal" href="#explicacao">Explicação</a>
        <ul>
    <li class="toctree-l4"><a class="reference internal" href="#queue">Queue</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#threads">Threads</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#demonstracao">Demonstração</a>
        <ul>
    <li class="toctree-l4"><a class="reference internal" href="#simplificada-queue">Simplificada - Queue</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#simplificada-threadpoolexecutor">Simplificada - ThreadPoolExecutor</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#completa-pratica">Completa - Prática</a>
    </li>
        </ul>
    </li>
    </ul>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../Aula%20993%20-%20Gerenciador%20de%20Contexto/">Aula 993 - Gerenciador de Contexto</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../Aula%20994%20-%20List%20Comprehension%2C%20Map%20e%20Filter/">Aula 994 - List Comprehension, Map e Filter</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../Aula%20995%20-%20Serializa%C3%A7%C3%A3o/">Aula 995 - Serialização</a>
                </li>
    </ul>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Temporada 1</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../S01/Aula%201%20-%20Introduc%CC%A7a%CC%83o/">Aula 1 - Instalação, IDEs, Variáveis, Tipagens, Condicionais e Extras</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../S01/Aula%202%20-%20Listas%2C%20Diciona%CC%81rios%20e%20Loopings/">Aula 2 - Listas, Dicionários e Loopings</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../S01/Aula%203%20-%20Func%CC%A7o%CC%83es%2C%20Manipulac%CC%A7o%CC%83es%20e%20Erros/">Aula 3 - Funções, Manipulações e Erros</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../S01/Aula%204%20-%20Bibliotecas%2C%20Excel%20e%20TXTs/">Aula 4 - Bibliotecas, Excel e TXTs</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../S01/Aula%205%20-%20Selenium%20e%20BeautifulSoup/">Aula 5 - Selenium e BeautifulSoup</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../S01/Aula%207%20-%20RegEx%20e%20APIs/">Aula 7 - RegEx e APIs</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../S01/Aula%208%20-%20Email%2C%20DBs%20e%20OO/">Aula 8 - Email, DBs e OO</a>
                  </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../..">RPA Pythonico</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../.." class="icon icon-home" alt="Docs"></a> &raquo;</li>
          <li>Temporada 2 &raquo;</li>
          <li>Extras &raquo;</li>
      <li>Aula 992 - Fila e Threads</li>
    <li class="wy-breadcrumbs-aside">
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h1 id="fila-e-threads">Fila e Threads</h1>
<h2 id="explicacao">Explicação</h2>
<h3 id="queue">Queue</h3>
<p>Em termos simples, uma fila é como uma linha de pessoas esperando para serem atendidas. As pessoas só podem entrar no final da fila e sair pelo começo. Da mesma forma, em uma fila de programação, as tarefas (ou "itens") só podem ser adicionadas ao final da fila e removidas do começo. Isso é conhecido como FIFO (First In, First Out), ou seja, o primeiro a entrar é o primeiro a sair.</p>
<h3 id="threads">Threads</h3>
<p>Imagine que você tem uma grande quantidade de trabalhos que precisam ser feitos, mas cada trabalho leva algum tempo para ser concluído. Em vez de fazer todos os trabalhos um após o outro (o que seria muito lento), você decide dividir o trabalho entre vários funcionários. Cada funcionário pode trabalhar em um trabalho de cada vez, e assim todos os trabalhos são concluídos mais rápido.</p>
<p>No mundo da programação, esses "trabalhos" são chamados de "tarefas" e os "funcionários" são chamados de "threads". O ThreadPoolExecutor é como um gerente que organiza esses funcionários e distribui as tarefas entre eles. Ele cria um grupo de threads e gerencia a execução das tarefas para que todas sejam concluídas de maneira eficiente.</p>
<h2 id="demonstracao">Demonstração</h2>
<h3 id="simplificada-queue">Simplificada - Queue</h3>
<ul>
<li>
<p>Importa a Fila</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="kn">from</span> <span class="nn">queue</span> <span class="kn">import</span> <span class="n">Queue</span>
</code></pre></div>
</li>
<li>
<p>Inicializa a fila</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a><span class="n">fila</span> <span class="o">=</span> <span class="n">Queue</span><span class="p">()</span>
</code></pre></div>
</li>
<li>
<p>Insere um valor na fila</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a><span class="n">fila</span><span class="o">.</span><span class="n">put</span><span class="p">(</span><span class="s1">&#39;qualquer valor&#39;</span><span class="p">)</span>
</code></pre></div>
</li>
<li>
<p>Retira um valor da fila para processar</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a><span class="n">valor</span> <span class="o">=</span> <span class="n">fila</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
</code></pre></div>
</li>
</ul>
<h3 id="simplificada-threadpoolexecutor">Simplificada - ThreadPoolExecutor</h3>
<ul>
<li>
<p>Importa o Executor de Threads</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a><span class="kn">from</span> <span class="nn">concurrent.futures</span> <span class="kn">import</span> <span class="n">ThreadPoolExecutor</span>
</code></pre></div>
</li>
<li>
<p>Gera alguma varíavel de interáveis (filas, listas, tuples, etc...)</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a><span class="n">itens_x</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">]</span>
</code></pre></div>
</li>
<li>
<p>Define a função que irá processar os valores</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-6-1" name="__codelineno-6-1" href="#__codelineno-6-1"></a><span class="k">def</span> <span class="nf">funcao_y</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
<a id="__codelineno-6-2" name="__codelineno-6-2" href="#__codelineno-6-2"></a>    <span class="k">pass</span>
</code></pre></div>
</li>
<li>
<p>Executa os processos de acordo com quantidade de Threads estipulada</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-7-1" name="__codelineno-7-1" href="#__codelineno-7-1"></a><span class="k">with</span> <span class="n">ThreadPoolExecutor</span><span class="p">(</span><span class="n">max_workers</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span> <span class="k">as</span> <span class="n">executor</span><span class="p">:</span>
<a id="__codelineno-7-2" name="__codelineno-7-2" href="#__codelineno-7-2"></a>    <span class="n">resultados</span> <span class="o">=</span> <span class="p">[</span><span class="n">executor</span><span class="o">.</span><span class="n">submit</span><span class="p">(</span><span class="n">funcao_y</span><span class="p">,</span> <span class="n">valor</span><span class="p">)</span> <span class="k">for</span> <span class="n">valor</span> <span class="ow">in</span> <span class="n">itens_x</span><span class="p">]</span>
</code></pre></div>
</li>
</ul>
<h3 id="completa-pratica">Completa - Prática</h3>
<ul>
<li>
<p>Importa as bibliotecas necessárias para o exemplo</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-8-1" name="__codelineno-8-1" href="#__codelineno-8-1"></a><span class="kn">from</span> <span class="nn">queue</span> <span class="kn">import</span> <span class="n">Queue</span> <span class="c1"># Funcionalidade da fila</span>
<a id="__codelineno-8-2" name="__codelineno-8-2" href="#__codelineno-8-2"></a><span class="kn">import</span> <span class="nn">requests</span> <span class="c1"># Efetua requisições HTTP</span>
<a id="__codelineno-8-3" name="__codelineno-8-3" href="#__codelineno-8-3"></a><span class="kn">import</span> <span class="nn">xml.etree.ElementTree</span> <span class="k">as</span> <span class="nn">ET</span> <span class="c1"># Permite analisar arquivos XMLs</span>
<a id="__codelineno-8-4" name="__codelineno-8-4" href="#__codelineno-8-4"></a><span class="kn">import</span> <span class="nn">json</span> <span class="c1"># Permite analisar arquivos JSON</span>
<a id="__codelineno-8-5" name="__codelineno-8-5" href="#__codelineno-8-5"></a><span class="kn">from</span> <span class="nn">concurrent.futures</span> <span class="kn">import</span> <span class="n">ThreadPoolExecutor</span> <span class="c1"># Funcionalidade das Threads</span>
</code></pre></div>
</li>
<li>
<p>Instancia a fila para ser preenchida</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-9-1" name="__codelineno-9-1" href="#__codelineno-9-1"></a><span class="n">fila</span> <span class="o">=</span> <span class="n">Queue</span><span class="p">()</span>
</code></pre></div>
</li>
<li>
<p>Adiciona moedas para dentro da fila (função <code>qsize()</code> mostra a quantidade de itens na fila)</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-10-1" name="__codelineno-10-1" href="#__codelineno-10-1"></a><span class="k">for</span> <span class="n">moeda</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;USD&#39;</span><span class="p">,</span> <span class="s1">&#39;EUR&#39;</span><span class="p">,</span> <span class="s1">&#39;JPY&#39;</span><span class="p">,</span> <span class="s1">&#39;GBP&#39;</span><span class="p">,</span> <span class="s1">&#39;ARS&#39;</span><span class="p">]:</span>
<a id="__codelineno-10-2" name="__codelineno-10-2" href="#__codelineno-10-2"></a>    <span class="n">fila</span><span class="o">.</span><span class="n">put</span><span class="p">(</span><span class="n">moeda</span><span class="p">)</span>
<a id="__codelineno-10-3" name="__codelineno-10-3" href="#__codelineno-10-3"></a>
<a id="__codelineno-10-4" name="__codelineno-10-4" href="#__codelineno-10-4"></a><span class="nb">print</span><span class="p">(</span><span class="n">fila</span><span class="o">.</span><span class="n">qsize</span><span class="p">())</span>
<a id="__codelineno-10-5" name="__codelineno-10-5" href="#__codelineno-10-5"></a><span class="c1"># resultado: 5</span>
</code></pre></div>
</li>
<li>
<p>Cria função para fazer a coleta da cotação para diferentes moedas</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-11-1" name="__codelineno-11-1" href="#__codelineno-11-1"></a><span class="k">def</span> <span class="nf">coleta_cotacao</span><span class="p">(</span><span class="n">moeda</span><span class="p">,</span> <span class="n">datas</span><span class="p">):</span>
<a id="__codelineno-11-2" name="__codelineno-11-2" href="#__codelineno-11-2"></a>    <span class="n">cotacoes</span> <span class="o">=</span> <span class="p">{</span><span class="n">moeda</span><span class="p">:</span> <span class="p">[]}</span> <span class="c1"># Dicionario vazio para popular futuramente com as cotações</span>
<a id="__codelineno-11-3" name="__codelineno-11-3" href="#__codelineno-11-3"></a>    <span class="n">siglas</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;USD&#39;</span><span class="p">:</span> <span class="s1">&#39;220&#39;</span><span class="p">,</span> <span class="s1">&#39;EUR&#39;</span><span class="p">:</span> <span class="s1">&#39;978&#39;</span><span class="p">,</span>
<a id="__codelineno-11-4" name="__codelineno-11-4" href="#__codelineno-11-4"></a>            <span class="s1">&#39;JPY&#39;</span><span class="p">:</span> <span class="s1">&#39;470&#39;</span><span class="p">,</span> <span class="s1">&#39;GBP&#39;</span><span class="p">:</span> <span class="s1">&#39;540&#39;</span><span class="p">,</span>
<a id="__codelineno-11-5" name="__codelineno-11-5" href="#__codelineno-11-5"></a>            <span class="s1">&#39;ARS&#39;</span><span class="p">:</span> <span class="s1">&#39;706&#39;</span><span class="p">}</span> <span class="c1"># Dicionário contendo a sigla e qual o código da moeda</span>
<a id="__codelineno-11-6" name="__codelineno-11-6" href="#__codelineno-11-6"></a>    <span class="k">for</span> <span class="n">data</span> <span class="ow">in</span> <span class="n">datas</span><span class="p">:</span> <span class="c1"># Para cada data informada, fazer 1 interação</span>
<a id="__codelineno-11-7" name="__codelineno-11-7" href="#__codelineno-11-7"></a>        <span class="n">retorno</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;https://www3.bcb.gov.br/bc_moeda/rest/converter/1/1/</span><span class="si">{</span><span class="n">siglas</span><span class="p">[</span><span class="n">moeda</span><span class="p">]</span><span class="si">}</span><span class="s1">/790/</span><span class="si">{</span><span class="n">data</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span> <span class="c1"># Faz requisição da cotação</span>
<a id="__codelineno-11-8" name="__codelineno-11-8" href="#__codelineno-11-8"></a>        <span class="n">root</span> <span class="o">=</span> <span class="n">ET</span><span class="o">.</span><span class="n">fromstring</span><span class="p">(</span><span class="n">retorno</span><span class="o">.</span><span class="n">text</span><span class="p">)</span> <span class="c1"># Converte o retorno XML em algo modificável pelo Python</span>
<a id="__codelineno-11-9" name="__codelineno-11-9" href="#__codelineno-11-9"></a>        <span class="n">cotacoes</span><span class="p">[</span><span class="n">moeda</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">({</span><span class="n">data</span><span class="p">:</span> <span class="n">root</span><span class="o">.</span><span class="n">text</span><span class="p">})</span> <span class="c1"># Adiciona data e o valor da cotação na chave contendo a sigla</span>
<a id="__codelineno-11-10" name="__codelineno-11-10" href="#__codelineno-11-10"></a>    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;cotacoes_</span><span class="si">{</span><span class="n">moeda</span><span class="si">}</span><span class="s1">.json&#39;</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">arqv</span><span class="p">:</span> <span class="c1"># Salva um arquivo .json final</span>
<a id="__codelineno-11-11" name="__codelineno-11-11" href="#__codelineno-11-11"></a>        <span class="n">json</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">cotacoes</span><span class="p">,</span> <span class="n">arqv</span><span class="p">)</span>
</code></pre></div>
</li>
<li>
<p>Instancia as "threads" para cada uma rodar uma moeda</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-12-1" name="__codelineno-12-1" href="#__codelineno-12-1"></a><span class="k">with</span> <span class="n">ThreadPoolExecutor</span><span class="p">(</span><span class="n">max_workers</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span> <span class="k">as</span> <span class="n">executor</span><span class="p">:</span> <span class="c1"># Gerenciador de contexto instanciado para executar as threads</span>
<a id="__codelineno-12-2" name="__codelineno-12-2" href="#__codelineno-12-2"></a>    <span class="n">results</span> <span class="o">=</span> <span class="p">[</span><span class="n">executor</span><span class="o">.</span><span class="n">submit</span><span class="p">(</span><span class="n">coleta_cotacao</span><span class="p">,</span>
<a id="__codelineno-12-3" name="__codelineno-12-3" href="#__codelineno-12-3"></a>                            <span class="n">fila</span><span class="o">.</span><span class="n">get</span><span class="p">(),</span>
<a id="__codelineno-12-4" name="__codelineno-12-4" href="#__codelineno-12-4"></a>                            <span class="p">[</span><span class="s1">&#39;2024-02-09&#39;</span><span class="p">,</span> <span class="s1">&#39;2024-02-08&#39;</span><span class="p">,</span> <span class="s1">&#39;2024-02-07&#39;</span><span class="p">,</span> <span class="s1">&#39;2024-02-06&#39;</span><span class="p">,</span>
<a id="__codelineno-12-5" name="__codelineno-12-5" href="#__codelineno-12-5"></a>                                <span class="s1">&#39;2024-02-05&#39;</span><span class="p">,</span> <span class="s1">&#39;2024-02-02&#39;</span><span class="p">,</span> <span class="s1">&#39;2024-02-01&#39;</span><span class="p">,</span> <span class="s1">&#39;2024-01-31&#39;</span><span class="p">,</span>
<a id="__codelineno-12-6" name="__codelineno-12-6" href="#__codelineno-12-6"></a>                                <span class="s1">&#39;2024-01-30&#39;</span><span class="p">,</span> <span class="s1">&#39;2024-01-29&#39;</span><span class="p">])</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">)]</span> <span class="c1"># List Comprehension interando uma &quot;queue&quot; com data padrões</span>
</code></pre></div>
</li>
</ul>
              
            </div>
          </div><footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="Footer Navigation">
        <a href="../Aula%20991%20-%20Decoradores/" class="btn btn-neutral float-left" title="Aula 991 - Decoradores"><span class="icon icon-circle-arrow-left"></span> Previous</a>
        <a href="../Aula%20993%20-%20Gerenciador%20de%20Contexto/" class="btn btn-neutral float-right" title="Aula 993 - Gerenciador de Contexto">Next <span class="icon icon-circle-arrow-right"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
      <p>RPA Pythonico @ 2022</p>
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
          
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
    
      <span><a href="../Aula%20991%20-%20Decoradores/" style="color: #fcfcfc">&laquo; Previous</a></span>
    
    
      <span><a href="../Aula%20993%20-%20Gerenciador%20de%20Contexto/" style="color: #fcfcfc">Next &raquo;</a></span>
    
  </span>
</div>
    <script>var base_url = '../..';</script>
    <script src="../../js/theme_extra.js" defer></script>
    <script src="../../js/theme.js" defer></script>
      <script src="../../search/main.js" defer></script>
    <script defer>
        window.onload = function () {
            SphinxRtdTheme.Navigation.enable(false);
        };
    </script>

</body>
</html>
